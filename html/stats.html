<html>
<head>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="datepicker.css">
    <link rel="stylesheet" href="datepicker.less">
    <link rel="stylesheet" href="bootstrap-responsive.min.css">
    <link rel="stylesheet" href="bootstrap-sortable.css">
    <link rel="stylesheet" href="bootstrap-modal.css">
    <script type="text/javascript" src="jquery"></script>
    <script type="text/javascript" src="bootstrap.min.js"></script>
    <script type="text/javascript" src="bootstrap-modal.js"></script>
    <script type="text/javascript" src="bootstrap-modalmanager.js"></script>
    <script type="text/javascript" src="datepicker.js"></script>

    <style type="text/css">
        body {
            padding-top: 60px;
        }
       .arrow {
            border-left: 5px;
        }
        th {
            padding-right: 20px !important;
        }
        #canvas {
            margin-top: 60px;
        }
    </style>
</head>
<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container">
                <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="brand" href="/">Analysis of Web Artifacts</a>
                <div class="nav-collapse collapse">
                    <ul class="nav">
                        <li class="active"><a href="/">Home</a></li>
                        <li><a href="/graphs">Graphs</a></li>
                        <li><a href="/stats">Stats</a></li>
                        <li><a href="/map">Map</a></li>
                        <li><a href="/clusterize">Clusterize</a></li>
                        <li><a href="/clusters">Clusters</a></li>
                    </ul>
              </div><!--/.nav-collapse -->
            </div>
        </div>
    </div>
    <div class="container" style="padding-top: 10px">
        <div class="row">
            <h3> Here we collect the request made by attackers toward external server</h3>
        </div>
        <div class="row">
            <div class="span3">
                <div class="span2 input-append date" id="dp_start" data-date-format="yyyy-mm-dd">
                    <input class="" id="start_date" size="16" type="text" >
                    <span class="add-on"><i class="icon-calendar"></i></span>
                </div>
            </div>
            <div class="span3 offset1">
                <div class="span2 input-append date" id="dp_end" data-date-format="yyyy-mm-dd">
                    <input class="" id="end_date" size="16" type="text" >
                    <span class="add-on"><i class="icon-calendar"></i></span>
                </div>
            </div>
            <button class="span3 offset1 btn btn-primary" id="ShowStatsbtn">Show Stats</button>
        </div>
        <div id="canvas">
        </div>
    </div>
    <div id="detailsModal" class="modal hide container fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
        </div>
        <div class="modal-body">
        <table class="table">
        <tbody>
            <tr>
                <td>Destination Ip</td>
                <td id="detailsDstIp"></td>
            </tr>
            <tr>
                <td>Destination Port</td>
                <td id="detailsDstPort"></td>
            </tr>
            <tr>
                <td>Destination Host</td>
                <td id="detailsDstHost"></td>
            </tr>
            <tr>
                <td>Number Of Requests</td>
                <td id="detailsNrRequests"></td>
            </tr>
            <tr>
                <td>First Request</td>
                <td id="detailsFirstRequest"></td>
            </tr>
            <tr>
                <td>Last Request</td>
                <td id="detailsLastRequest"></td>
            </tr>
            <tr>
                <td>Minimum Time Interval</td>
                <td id="detailsMinTimeInt"></td>
            </tr>
            <tr>
                <td>Maximum Time Interval</td>
                <td id="detailsMaxTimeInt"></td>
            </tr>
            <tr>
                <td>Average Time Interval</td>
                <td id="detailsAvgTimeInt"></td>
            </tr>
            <tr>
                <td>Requests Longest Common Prefix</td>
                <td id="detailsLongPrefixReq"></td>
            </tr>
        </tbody>
        </table>
        <div style="max-height: 200px; overflow:scroll">
        <table class="table table-striped sortable" id="requestsDetails" style="">
            <thead>
                <tr><th data-defaultsort='asc'>Time<span class='arrow'></span></th>
                <th data-defaultsort='asc'>Request<span class='arrow'></span></th></tr>
            </thead>
            <tbody id="requestsDetailsBody">

            </tbody>
        </table>
    </div>
        </div>
        <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
        </div>
    </div>
</body>
<script type="text/javascript" src="stats_manager.js"></script>
<script type="text/javascript" src="bootstrap-sortable.js"></script>
</html>
